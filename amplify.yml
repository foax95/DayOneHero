version: 1
applications:
  - appRoot: .
    frontend:
      phases:
        build:
          commands:
            - "echo 'No frontend build required - static files'"
      artifacts:
        baseDirectory: src/main/resources/static
        files:
          - '**/*'
    backend:
      phases:
        preBuild:
          commands:
            - "curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash"
            - "export NVM_DIR=\"$HOME/.nvm\""
            - "[ -s \"$NVM_DIR/nvm.sh\" ] && \\. \"$NVM_DIR/nvm.sh\""
            - "nvm install 16"
            - "nvm use 16"
            - "node -v"
            - "sudo amazon-linux-extras enable corretto8"
            - "sudo yum install -y java-11-amazon-corretto-devel maven"
            - "export JAVA_HOME=/usr/lib/jvm/java-11-amazon-corretto"
            - "export PATH=$PATH:$JAVA_HOME/bin"
            - "java -version"
            - "mvn -v"
        build:
          commands:
            - "mvn clean package"
      artifacts:
        baseDirectory: target
        files:
          - '**/*'
